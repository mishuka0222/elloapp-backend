// Copyright 2022 Teamgram Authors
//  All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//
// Author: teamgramio (teamgram.io@gmail.com)
//

package crypto

import (
	"encoding/hex"
	"fmt"
	"testing"
)

func makeTestAlog() *PasswordKdfAlgoModPow {
	var (
		// salt1: EC F8 73 76 65 BC 77 5A [8 BYTES],
		// salt2: BE DE 48 88 8C 0F 42 AC 34 FF D1 D4 93 5D 8B 21 [16 BYTES],

		gNewAlgoSalt1 = []byte{0xEC, 0xF8, 0x73, 0x76, 0x65, 0xBC, 0x77, 0x5A}
		gNewAlgoSalt2 = []byte{0xBE, 0xDE, 0x48, 0x88, 0x8C, 0x0F, 0x42, 0xAC, 0x34, 0xFF, 0xD1, 0xD4, 0x93, 0x5D, 0x8B, 0x21}

		gNewAlgoP = []byte{
			0xc7, 0x1c, 0xae, 0xb9, 0xc6, 0xb1, 0xc9, 0x04, 0x8e, 0x6c, 0x52, 0x2f,
			0x70, 0xf1, 0x3f, 0x73, 0x98, 0x0d, 0x40, 0x23, 0x8e, 0x3e, 0x21, 0xc1,
			0x49, 0x34, 0xd0, 0x37, 0x56, 0x3d, 0x93, 0x0f, 0x48, 0x19, 0x8a, 0x0a,
			0xa7, 0xc1, 0x40, 0x58, 0x22, 0x94, 0x93, 0xd2, 0x25, 0x30, 0xf4, 0xdb,
			0xfa, 0x33, 0x6f, 0x6e, 0x0a, 0xc9, 0x25, 0x13, 0x95, 0x43, 0xae, 0xd4,
			0x4c, 0xce, 0x7c, 0x37, 0x20, 0xfd, 0x51, 0xf6, 0x94, 0x58, 0x70, 0x5a,
			0xc6, 0x8c, 0xd4, 0xfe, 0x6b, 0x6b, 0x13, 0xab, 0xdc, 0x97, 0x46, 0x51,
			0x29, 0x69, 0x32, 0x84, 0x54, 0xf1, 0x8f, 0xaf, 0x8c, 0x59, 0x5f, 0x64,
			0x24, 0x77, 0xfe, 0x96, 0xbb, 0x2a, 0x94, 0x1d, 0x5b, 0xcd, 0x1d, 0x4a,
			0xc8, 0xcc, 0x49, 0x88, 0x07, 0x08, 0xfa, 0x9b, 0x37, 0x8e, 0x3c, 0x4f,
			0x3a, 0x90, 0x60, 0xbe, 0xe6, 0x7c, 0xf9, 0xa4, 0xa4, 0xa6, 0x95, 0x81,
			0x10, 0x51, 0x90, 0x7e, 0x16, 0x27, 0x53, 0xb5, 0x6b, 0x0f, 0x6b, 0x41,
			0x0d, 0xba, 0x74, 0xd8, 0xa8, 0x4b, 0x2a, 0x14, 0xb3, 0x14, 0x4e, 0x0e,
			0xf1, 0x28, 0x47, 0x54, 0xfd, 0x17, 0xed, 0x95, 0x0d, 0x59, 0x65, 0xb4,
			0xb9, 0xdd, 0x46, 0x58, 0x2d, 0xb1, 0x17, 0x8d, 0x16, 0x9c, 0x6b, 0xc4,
			0x65, 0xb0, 0xd6, 0xff, 0x9c, 0xa3, 0x92, 0x8f, 0xef, 0x5b, 0x9a, 0xe4,
			0xe4, 0x18, 0xfc, 0x15, 0xe8, 0x3e, 0xbe, 0xa0, 0xf8, 0x7f, 0xa9, 0xff,
			0x5e, 0xed, 0x70, 0x05, 0x0d, 0xed, 0x28, 0x49, 0xf4, 0x7b, 0xf9, 0x59,
			0xd9, 0x56, 0x85, 0x0c, 0xe9, 0x29, 0x85, 0x1f, 0x0d, 0x81, 0x15, 0xf6,
			0x35, 0xb1, 0x05, 0xee, 0x2e, 0x4e, 0x15, 0xd0, 0x4b, 0x24, 0x54, 0xbf,
			0x6f, 0x4f, 0xad, 0xf0, 0x34, 0xb1, 0x04, 0x03, 0x11, 0x9c, 0xd8, 0xe3,
			0xb9, 0x2f, 0xcc, 0x5b,
		}

		gNewAlgoG = int32(3)

		// gNewSecureAlgoSalt = []byte{0x7D, 0x04, 0xB3, 0x4B, 0x94, 0x82, 0x8C, 0x3D}
	)

	return &PasswordKdfAlgoModPow{
		Salt1: gNewAlgoSalt1,
		Salt2: gNewAlgoSalt2,
		G:     gNewAlgoG,
		P:     gNewAlgoP,
	}
}

/*
[08:37:24.632 00-0000667] a: F6ACA74040832B58EFD53A121ACC3B73CD43A8C3F0BAB2BDD7A0FC2878A899AB34EA4AFCA00DFC91E1005D1B795EA4E93A090845EA2D8ACEC3B817508EE5F86F06163C91B39B677CA8D8366DA8FFC2D6AE74F67D3942652535516FA60B7B1C1116B6B75EF25B219159430747E7EE779173977F47DD3981CC5D993E7E53ACAA64FD73D924C144D9674081C0CCC74F680F1E10E0AFBDB0338A3326B6A4D6CCDDDEF0F6B7D016339C752EB07FA29EF6CA78EAAE45FD5C68FDCDB73408EB78AA4A19A7A6EE53A4D7118A4523390FCBA638FCB1BA4937B27B5F6E188F8C9677168FEDB6864CB6D5A184475830325E3DD0B753FD69CC0A7D118E21FBA1189834C39D8F
[08:37:24.633 00-0000668] A: 7A1CDBB30AEB2A2D80CBC3CC123471E08B706C78D84EBC3DC200D4598E0DAEEF65AC491865E2E81E0146C1CDAC65CB219BB798DAC847FCB823930BE2D2413B97D93CE6F51699C94F43518EB990A63837E953ED45995958E0CFB1E229BDC63F379B62C122B8F5B5A73F3511355062B4278FBC81B6AD4EC1420479CD1FE713DA217BA06F52896F4265D937AE641DB047B04330A8725FFAE7BB21B8E998B6289749F2EAD89578A148531D190B40B009DDE6071C5B0AF2DD648361A1247A1E0F1954FE37E4595957193CB5170F607E4CDFB85B93AFEF31E5846AFFE333E63EA953C072F269E29CCD6BD7D16568E4ED57BBB2CCED0104E83D20503ED2DD2B00D08CF7
[08:37:24.633 00-0000669] u: E1D3747E1120A73A469456F6131E905EBBB05ED3F5B1D9B4731711AC504BF3F1

[08:37:24.637 00-0000670] pForHash: C71CAEB9C6B1C9048E6C522F70F13F73980D40238E3E21C14934D037563D930F48198A0AA7C14058229493D22530F4DBFA336F6E0AC925139543AED44CCE7C3720FD51F69458705AC68CD4FE6B6B13ABDC9746512969328454F18FAF8C595F642477FE96BB2A941D5BCD1D4AC8CC49880708FA9B378E3C4F3A9060BEE67CF9A4A4A695811051907E162753B56B0F6B410DBA74D8A84B2A14B3144E0EF1284754FD17ED950D5965B4B9DD46582DB1178D169C6BC465B0D6FF9CA3928FEF5B9AE4E418FC15E83EBEA0F87FA9FF5EED70050DED2849F47BF959D956850CE929851F0D8115F635B105EE2E4E15D04B2454BF6F4FADF034B10403119CD8E3B92FCC5B
[08:37:24.637 00-0000671] gForHash: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003
[08:37:24.637 00-0000672] algo.salt1: ECF8737665BC775A370F27FE8164B9015E3DC3735F57A13CB2C4F73EA1D642A8E74D898FC8DEB30A
[08:37:24.637 00-0000673] algo.salt2: BEDE48888C0F42AC34FFD1D4935D8B21
[08:37:24.637 00-0000674] algo.salt2: BEDE48888C0F42AC34FFD1D4935D8B21
[08:37:24.637 00-0000675] AForHash: 7A1CDBB30AEB2A2D80CBC3CC123471E08B706C78D84EBC3DC200D4598E0DAEEF65AC491865E2E81E0146C1CDAC65CB219BB798DAC847FCB823930BE2D2413B97D93CE6F51699C94F43518EB990A63837E953ED45995958E0CFB1E229BDC63F379B62C122B8F5B5A73F3511355062B4278FBC81B6AD4EC1420479CD1FE713DA217BA06F52896F4265D937AE641DB047B04330A8725FFAE7BB21B8E998B6289749F2EAD89578A148531D190B40B009DDE6071C5B0AF2DD648361A1247A1E0F1954FE37E4595957193CB5170F607E4CDFB85B93AFEF31E5846AFFE333E63EA953C072F269E29CCD6BD7D16568E4ED57BBB2CCED0104E83D20503ED2DD2B00D08CF7
[08:37:24.637 00-0000676] BForHash: 76F4B479EDF09F23F47543058C166C92A5872679A077156C455D5F3C9A3B8009D8D4A6AB237BE707EA683CF278B93824F37B7069A6E92270FFBD482E971C49FBAA6E27FAC0061F8CB970D2D6E2DA435C6FFBBDA5158C84F1AB8F86A0AEED3BBA3342EFCDC722F31EE38F29079B54D405FCFC9B54FBFCBC5E6A034851922277491713184BADEB0B98BEF59819F3D0D4578A0D41CCA15D5D1AD30B63943A69B404DFD2CDD801469C93A3C6BEA3B47FF98A3414F5309E1C2EAE798856513D225848E0C07A21D5B240BE296C0C8C2F3CEC3D43446243A1277B5EA6AB045F644404317FDD16847902A8A86F384F429E6F827F8B4206CE781D3C7FA0BA27E36E84B9AE
[08:37:24.637 00-0000677] K: 2EA6A82CBE39331576996D57108293CCFB3109433FFB1EC87DDD7F786DEBBA68

pHash: c71caeb9c6b1c9048e6c522f70f13f73980d40238e3e21c14934d037563d930f48198a0aa7c14058229493d22530f4dbfa336f6e0ac925139543aed44cce7c3720fd51f69458705ac68cd4fe6b6b13abdc9746512969328454f18faf8c595f642477fe96bb2a941d5bcd1d4ac8cc49880708fa9b378e3c4f3a9060bee67cf9a4a4a695811051907e162753b56b0f6b410dba74d8a84b2a14b3144e0ef1284754fd17ed950d5965b4b9dd46582db1178d169c6bc465b0d6ff9ca3928fef5b9ae4e418fc15e83ebea0f87fa9ff5eed70050ded2849f47bf959d956850ce929851f0d8115f635b105ee2e4e15d04b2454bf6f4fadf034b10403119cd8e3b92fcc5b
gHash: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003
newSalt1: ecf8737665bc775a370f27fe8164b9015e3dc3735f57a13cb2c4f73ea1d642a8e74d898fc8deb30a
m.Salt2: bede48888c0f42ac34ffd1d4935d8b21
ABytes: 7a1cdbb30aeb2a2d80cbc3cc123471e08b706c78d84ebc3dc200d4598e0daeef65ac491865e2e81e0146c1cdac65cb219bb798dac847fcb823930be2d2413b97d93ce6f51699c94f43518eb990a63837e953ed45995958e0cfb1e229bdc63f379b62c122b8f5b5a73f3511355062b4278fbc81b6ad4ec1420479cd1fe713da217ba06f52896f4265d937ae641db047b04330a8725ffae7bb21b8e998b6289749f2ead89578a148531d190b40b009dde6071c5b0af2dd648361a1247a1e0f1954fe37e4595957193cb5170f607e4cdfb85b93afef31e5846affe333e63ea953c072f269e29ccd6bd7d16568e4ed57bbb2cced0104e83d20503ed2dd2b00d08cf7
BBytes: 76f4b479edf09f23f47543058c166c92a5872679a077156c455d5f3c9a3b8009d8d4a6ab237be707ea683cf278b93824f37b7069a6e92270ffbd482e971c49fbaa6e27fac0061f8cb970d2d6e2da435c6ffbbda5158c84f1ab8f86a0aeed3bba3342efcdc722f31ee38f29079b54d405fcfc9b54fbfcbc5e6a034851922277491713184badeb0b98bef59819f3d0d4578a0d41cca15d5d1ad30b63943a69b404dfd2cdd801469c93a3c6bea3b47ff98a3414f5309e1c2eae798856513d225848e0c07a21d5b240be296c0c8c2f3cec3d43446243a1277b5ea6ab045f644404317fdd16847902a8a86f384f429e6f827f8b4206ce781d3c7fa0ba27e36e84b9ae
KBytes: 2ea6a82cbe39331576996d57108293ccfb3109433ffb1ec87ddd7f786debba68

pHash: c71caeb9c6b1c9048e6c522f70f13f73980d40238e3e21c14934d037563d930f48198a0aa7c14058229493d22530f4dbfa336f6e0ac925139543aed44cce7c3720fd51f69458705ac68cd4fe6b6b13abdc9746512969328454f18faf8c595f642477fe96bb2a941d5bcd1d4ac8cc49880708fa9b378e3c4f3a9060bee67cf9a4a4a695811051907e162753b56b0f6b410dba74d8a84b2a14b3144e0ef1284754fd17ed950d5965b4b9dd46582db1178d169c6bc465b0d6ff9ca3928fef5b9ae4e418fc15e83ebea0f87fa9ff5eed70050ded2849f47bf959d956850ce929851f0d8115f635b105ee2e4e15d04b2454bf6f4fadf034b10403119cd8e3b92fcc5b
gHash: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003
newSalt1: ecf8737665bc775a370f27fe8164b9015e3dc3735f57a13cb2c4f73ea1d642a8e74d898fc8deb30a
m.Salt2: bede48888c0f42ac34ffd1d4935d8b21
ABytes: 7a1cdbb30aeb2a2d80cbc3cc123471e08b706c78d84ebc3dc200d4598e0daeef65ac491865e2e81e0146c1cdac65cb219bb798dac847fcb823930be2d2413b97d93ce6f51699c94f43518eb990a63837e953ed45995958e0cfb1e229bdc63f379b62c122b8f5b5a73f3511355062b4278fbc81b6ad4ec1420479cd1fe713da217ba06f52896f4265d937ae641db047b04330a8725ffae7bb21b8e998b6289749f2ead89578a148531d190b40b009dde6071c5b0af2dd648361a1247a1e0f1954fe37e4595957193cb5170f607e4cdfb85b93afef31e5846affe333e63ea953c072f269e29ccd6bd7d16568e4ed57bbb2cced0104e83d20503ed2dd2b00d08cf7
BBytes: 76f4b479edf09f23f47543058c166c92a5872679a077156c455d5f3c9a3b8009d8d4a6ab237be707ea683cf278b93824f37b7069a6e92270ffbd482e971c49fbaa6e27fac0061f8cb970d2d6e2da435c6ffbbda5158c84f1ab8f86a0aeed3bba3342efcdc722f31ee38f29079b54d405fcfc9b54fbfcbc5e6a034851922277491713184badeb0b98bef59819f3d0d4578a0d41cca15d5d1ad30b63943a69b404dfd2cdd801469c93a3c6bea3b47ff98a3414f5309e1c2eae798856513d225848e0c07a21d5b240be296c0c8c2f3cec3d43446243a1277b5ea6ab045f644404317fdd16847902a8a86f384f429e6f827f8b4206ce781d3c7fa0ba27e36e84b9ae
KBytes: ec47a1ea0b9ee9d0d418cabe49451b226ca8092cc7081dc0a440bf927b4b3125
M
*/
func TestSRPUtil(t *testing.T) {

	newSalt1S := "ecf8737665bc775a370f27fe8164b9015e3dc3735f57a13cb2c4f73ea1d642a8e74d898fc8deb30a"
	// ecf8737665bc775a95d0172bcb1a5197a762db6fbef84e6fb0476bbecfe7cf2092176ceabffdf29e
	newSalt1, _ := hex.DecodeString(newSalt1S)

	fmt.Println("newSalt1: " + hex.EncodeToString(newSalt1))

	//newSalt1 = []byte{
	//	0xEC, 0xF8, 0x73, 0x76, 0x65, 0xBC, 0x77, 0x5A,
	//	//0x1F, 0xAB, 0x13, 0xF8, 0xFB, 0xEE, 0x3F, 0x85,
	//	//0x35, 0x39, 0xF1, 0x69, 0x74, 0xB4, 0x31, 0x55,
	//	//0x02, 0xBC, 0x9C, 0x4C, 0x8E, 0x33, 0x97, 0xD5,
	//	//0x47, 0x0D, 0x78, 0x94, 0x92, 0x28, 0x23, 0x10,
	//	0x48, 0xDE, 0xC1, 0x82, 0xE6, 0xA6, 0x63, 0xBE,
	//	0xC1, 0xDB, 0xCF, 0xDD, 0x01, 0xC7, 0x9D, 0x2C,
	//	0x92, 0x84, 0xBA, 0x0F, 0xD9, 0x07, 0xBE, 0x45,
	//	0x0F, 0x55, 0x9A, 0x7F, 0x48, 0x19, 0xFA, 0xDE,
	//}
	//

	srpUtil := MakeSRPUtil(makeTestAlog())

	fmt.Println("V: bc2820ba3a09f4f4514db146215f945f52b3c31cd18e724444535d1ffdae6c0c86fa9e94ba3b421678da6707295e7131b709a66e27505ab1413150298a73c7c6661e7acc3deead536e547ff5f294cffce7eca1d19f2c5e1995c6eda7518be18a8f90cb5216955c6cfd30600491dd23c5c4a40e3aa69e451718e2f3dff3a922a4c78ebe40f9645e5db26d2197e7edb193acc90563fdd3bfc504a556c0182f5d5117721d2336399c1718299ea5fd9f967afe3d58784322546eb661c723f5e6176ea690b84973acec6ed0c9408cc0fa7f30ab270d6e6656c45c42f5778ce7a7a36713533966e13251035a3fab8dd37d652450aee1e636f224fcc84edde9507d8075")
	vBytes := srpUtil.GetVBytes(newSalt1, []byte("123456"))
	// , gNewAlgo.To_PasswordKdfAlgoModPow())
	fmt.Print("new_password_hash: ")
	fmt.Println(hex.EncodeToString(vBytes))

	// 2b084edd60424af09bdba816b2419977881803b662f44e90f1e1ddc1ad2fbf133a1734ce15372fa7afa6bfa0291ffff4f9d5470d6a9999377ecfc37fc513075e721f19657e94e912776df0e38aa0bc690b66f75b3d518e94de79a97ab1ff3acbf749809f4fa7a2ba77985443a821b3c443b8da311440500ee53865be36c60f4ecbdcf71c7cf3c43faab96cc69ebbaa06683b47d9cfa6ed3a2805ed710ac040a2518fcb9cfc0a0545e8593327b4dc9267c04583b67cd973d2318caee591f2c0a8795bac44ec143069249e6f08e6c6609c03b05ab54a995850c552da155e0fdc38107e7e49069c0026f834fe1e7d127e64e6a08655bec0045c87f192a7eca9d205
	srpb, srpB := srpUtil.CalcSRPB(vBytes)

	//srpbHex := "d351efa123fa467050178fa07cc65f7c2a25587159ad205ccd2492a6bd0f3c48d5bb5cdf247902925ba2570db793c583d2202030581dfc2bbdb97781575756b7d1b84430430b431dc7ce12b94ec5478477b1e63901aecd116058fb186265b933129d311cdf48151f5fd720472253e75f7ff5d09ccdd64d3cdc1deafde6563f0cbd5e86958174b3d3f3819887436406209712c540e40042b050f2ff84ceeaadef38b554eeeb0ca73e0687394da2061ca8aa41a077e8fd9de9bbac1e4ffbb7d29f4726e1efb1e1bd91162698bd838f32bc2b115526c9adbe653daec995b2e42fb936cf66ef4f0bd6b60ae367d97b6ab50a85433a4f6bc697403284d69ba39612db"
	//srpBHex := "76f4b479edf09f23f47543058c166c92a5872679a077156c455d5f3c9a3b8009d8d4a6ab237be707ea683cf278b93824f37b7069a6e92270ffbd482e971c49fbaa6e27fac0061f8cb970d2d6e2da435c6ffbbda5158c84f1ab8f86a0aeed3bba3342efcdc722f31ee38f29079b54d405fcfc9b54fbfcbc5e6a034851922277491713184badeb0b98bef59819f3d0d4578a0d41cca15d5d1ad30b63943a69b404dfd2cdd801469c93a3c6bea3b47ff98a3414f5309e1c2eae798856513d225848e0c07a21d5b240be296c0c8c2f3cec3d43446243a1277b5ea6ab045f644404317fdd16847902a8a86f384f429e6f827f8b4206ce781d3c7fa0ba27e36e84b9ae"
	//
	//srpb, _ := hex.DecodeString(srpbHex)
	//srpB, _ := hex.DecodeString(srpBHex)

	// calcB(newPasswordHash, gNewAlgo.To_PasswordKdfAlgoModPow())
	fmt.Print("srpb: ")
	fmt.Println(hex.EncodeToString(srpb))
	fmt.Print("srp_B: ")
	fmt.Println(hex.EncodeToString(srpB))

	xBytes := srpUtil.GetX(newSalt1, []byte("123456"))
	fmt.Print("x: ")
	fmt.Println(hex.EncodeToString(xBytes))
	//A, M1 := srpUtil.CalcClientM(newSalt1, xBytes, srpB)
	//
	//fmt.Print("M1: ")
	//fmt.Println(hex.EncodeToString(M1))
	////fmt.Print("A: ")
	////fmt.Println(hex.EncodeToString(A))
	//
	////x := new(big.Int).SetBytes(newPasswordHash)
	////v := new(big.Int).Exp(srpUtil.g, x, srpUtil.p)
	//M := srpUtil.CalcM(newSalt1, vBytes, A, srpb, srpB)
	//fmt.Print("M : ")
	//fmt.Println(hex.EncodeToString(M))
	//
	////b := "b4ca31e7e7693a5af8574d91be731ab763279d6d051755697d66178c1d22fb84cab0cf7d8833504dcd7550f537deac7c3a28d4bacf0ed32ae18b264ba753953750b3899297f6777f04d93d3baeaabb424033a67ac8f6c9ff584f239573e9db3589af4b188bdfd1692e839b0352af7b36b0243db5592a2954ef8aaf5f0d807bf45c3604f8afd03b9ed93f066814a9b7125b9b318644f4b0bb2fb2c8be6ec69162c678c14603b5c720344bf74e18204ae7d7b1c54ddbe5650966596c86cdd9102e3ac427249ae034d0e74d80281be5a70424bf7ff6cf5eab3aadfec0075f926294ad6e86ef237c7a71b77d2b9113cd829a7168f0f22cd3eb59a0376b2757937448"
	////bBytes, _ := hex.DecodeString(b)
	////B := srpUtil.CalcSRPB2(bBytes, vBytes)
	////fmt.Println(hex.EncodeToString(B))
	////

	a2 := "F6ACA74040832B58EFD53A121ACC3B73CD43A8C3F0BAB2BDD7A0FC2878A899AB34EA4AFCA00DFC91E1005D1B795EA4E93A090845EA2D8ACEC3B817508EE5F86F06163C91B39B677CA8D8366DA8FFC2D6AE74F67D3942652535516FA60B7B1C1116B6B75EF25B219159430747E7EE779173977F47DD3981CC5D993E7E53ACAA64FD73D924C144D9674081C0CCC74F680F1E10E0AFBDB0338A3326B6A4D6CCDDDEF0F6B7D016339C752EB07FA29EF6CA78EAAE45FD5C68FDCDB73408EB78AA4A19A7A6EE53A4D7118A4523390FCBA638FCB1BA4937B27B5F6E188F8C9677168FEDB6864CB6D5A184475830325E3DD0B753FD69CC0A7D118E21FBA1189834C39D8F"
	a2Bytes, _ := hex.DecodeString(a2)
	fmt.Println("a: " + hex.EncodeToString(a2Bytes))

	A2 := "7A1CDBB30AEB2A2D80CBC3CC123471E08B706C78D84EBC3DC200D4598E0DAEEF65AC491865E2E81E0146C1CDAC65CB219BB798DAC847FCB823930BE2D2413B97D93CE6F51699C94F43518EB990A63837E953ED45995958E0CFB1E229BDC63F379B62C122B8F5B5A73F3511355062B4278FBC81B6AD4EC1420479CD1FE713DA217BA06F52896F4265D937AE641DB047B04330A8725FFAE7BB21B8E998B6289749F2EAD89578A148531D190B40B009DDE6071C5B0AF2DD648361A1247A1E0F1954FE37E4595957193CB5170F607E4CDFB85B93AFEF31E5846AFFE333E63EA953C072F269E29CCD6BD7D16568E4ED57BBB2CCED0104E83D20503ED2DD2B00D08CF7"
	// 61089F85E3790945435CB25B76BCB4A124BAA763D3AD4E7376C3580A967420C2CAE455BD04D79775ABE9B65FC36BB3F0C182EAFAE9CAB20674BE16A01247128AD28FDA49B74E95473017482AE336E507B7310BC992EDAAF90CF5CD0DD54DD8D01879723A4525B44E6109CD451EAC29F05214A222DFB614AF8D7A9A13D7062A55A83D96C7D5DCA80183A5BE363C76139A25509463B6C3C28307718A9075C5644EE9DA43207246F1DCBDE9931A15CFB729A73444C91871E4C02B530671FDDEB8E8D18B19921BED791D0F32C81885171AC10668B01A5B89E0B866CD2908F72851044AA7F60D761F5DEC9415568AD6D7661B7ED958C1D55603C8B4526C1C100EB8D
	A2Bytes, _ := hex.DecodeString(A2)
	fmt.Println("A: " + hex.EncodeToString(A2Bytes))

	fmt.Println("--------------------------------------")
	fmt.Println("--------------------------------------")
	M2 := srpUtil.CalcClientM2(newSalt1, a2Bytes, A2Bytes, xBytes, srpB)
	fmt.Print("M-C : ")
	fmt.Println(hex.EncodeToString(M2))

	fmt.Println("--------------------------------------")
	fmt.Println("--------------------------------------")
	M := srpUtil.CalcM(newSalt1, vBytes, A2Bytes, srpb, srpB)
	fmt.Print("M-S : ")
	fmt.Println(hex.EncodeToString(M))

	//
	//fmt.Println("")
	//fmt.Println("--------------------------------------")
	//fmt.Println(hex.EncodeToString(newSalt1))
	//fmt.Println(hex.EncodeToString(vBytes))
	//fmt.Println(hex.EncodeToString(ABytes))
	//fmt.Println(hex.EncodeToString(bBytes))
	//fmt.Println(hex.EncodeToString(B))

}

//2019-03-16T18:33:32.867326Z	info	core/password_data.go:493	81d76d424ffc387cf1408faed0e444d32995c5358a6b2b82df9467dbdfa8e053
//2019-03-16T18:33:32.867341Z	info	core/password_data.go:494	6d7afa362ca30cc2685d0ec3ddf4135254d2662985220f827ffb5a69121236f9

//[02:33:32.610 00-0000776] 3ADD91CBC5444E7EE98BF9624D9A4E8ADC64B3AB6B984303953C3A6C04428120F7A70D81081C0CF9B65C0BEB02F19772556FBBB69579A203B8D0617314096DBD54C336E78E53E3FD0E01F2C8F66660A9A95201539F89A7466D26AE6CB06486D737598C2947344D3C51DB0EAC76CF970EFDA95EA85084DCA2B8D38D8545A32FC8344214845E00AD0B663736FB265342CAA960EA618CB99A6990954674BD695806132835466638293185C6293D8C76AD65B465C166F785DA82A4869BC01D55788FB0954E161F5A35C5556314AFD28927746D51E8A06A0FBCE029654B824CD39A2F4BB19CC84EEB1C04FFD7EAC037B49FED8735BA3175BCAAFB6ECFCADF410BD5D
//[02:33:32.610 00-0000777] 61089F85E3790945435CB25B76BCB4A124BAA763D3AD4E7376C3580A967420C2CAE455BD04D79775ABE9B65FC36BB3F0C182EAFAE9CAB20674BE16A01247128AD28FDA49B74E95473017482AE336E507B7310BC992EDAAF90CF5CD0DD54DD8D01879723A4525B44E6109CD451EAC29F05214A222DFB614AF8D7A9A13D7062A55A83D96C7D5DCA80183A5BE363C76139A25509463B6C3C28307718A9075C5644EE9DA43207246F1DCBDE9931A15CFB729A73444C91871E4C02B530671FDDEB8E8D18B19921BED791D0F32C81885171AC10668B01A5B89E0B866CD2908F72851044AA7F60D761F5DEC9415568AD6D7661B7ED958C1D55603C8B4526C1C100EB8D

//2019-03-16T18:33:32.866932Z	info	core/password_data.go:488	ecf8737665bc775a95d0172bcb1a5197a762db6fbef84e6fb0476bbecfe7cf2092176ceabffdf29e
//2019-03-16T18:33:32.866970Z	info	core/password_data.go:489	2b084edd60424af09bdba816b2419977881803b662f44e90f1e1ddc1ad2fbf133a1734ce15372fa7afa6bfa0291ffff4f9d5470d6a9999377ecfc37fc513075e721f19657e94e912776df0e38aa0bc690b66f75b3d518e94de79a97ab1ff3acbf749809f4fa7a2ba77985443a821b3c443b8da311440500ee53865be36c60f4ecbdcf71c7cf3c43faab96cc69ebbaa06683b47d9cfa6ed3a2805ed710ac040a2518fcb9cfc0a0545e8593327b4dc9267c04583b67cd973d2318caee591f2c0a8795bac44ec143069249e6f08e6c6609c03b05ab54a995850c552da155e0fdc38107e7e49069c0026f834fe1e7d127e64e6a08655bec0045c87f192a7eca9d205
//2019-03-16T18:33:32.866982Z	info	core/password_data.go:490	61089f85e3790945435cb25b76bcb4a124baa763d3ad4e7376c3580a967420c2cae455bd04d79775abe9b65fc36bb3f0c182eafae9cab20674be16a01247128ad28fda49b74e95473017482ae336e507b7310bc992edaaf90cf5cd0dd54dd8d01879723a4525b44e6109cd451eac29f05214a222dfb614af8d7a9a13d7062a55a83d96c7d5dca80183a5be363c76139a25509463b6c3c28307718a9075c5644ee9da43207246f1dcbde9931a15cfb729a73444c91871e4c02b530671fddeb8e8d18b19921bed791d0f32c81885171ac10668b01a5b89e0b866cd2908f72851044aa7f60d761f5dec9415568ad6d7661b7ed958c1d55603c8b4526c1c100eb8d0
//2019-03-16T18:33:32.867147Z	info	core/password_data.go:491	5aeb9be7c4228a98bf60d89087516db815077673e54ed2241c05b0208865c345d0f2b6c4e4436b8f99d2f9fc255dad5f6078624a93bcc11c77891a55c572e2be63ae9f41fc48d042186cc466a1f17e7e5d3402043f8dfdb987ab7a0bb82ec8819a8aa453bf6c8d9f1d29738c1da3f7633be36e0579b20837353dfd30f429dbb16a94069cc49c20529ff11457bf9e73990fcc5451fc51bc2a9c9ba21ab6070dcb666d65b3535a13aa96be575a234eb007b1b7a292dbf72cc66fa5a2e48d70dfefd24ef223f46840dc918fac3305f57321ac469a73263055c09e9d66c9b26e114f5a97330e7cec179d66f8f74086c0f88560c72b32e24e9e22c0468b6324798795
//2019-03-16T18:33:32.867166Z	info	core/password_data.go:492	b5891accbe53725dcbd164381e21c9a1c1198bfeeeed5cc456202525bbc52cb68755c334ca78f093a7abe71c4e558f4501f6d3872bd69c89eba79684c1f3ffe60885400c85273510834edcafb639d736291891e0a8c8cc8a339773bc64d78680239b250f3cd733b3791fc8d3a9b8357a0e8ccd87387fd949b42bf66229c66890030aac6f97ad5a77b8e9496e9f427dd24ea61a57dccaa09edc53cf87a7b15823a8fdb6e5e683a7c6088aaca782c76081c761584153adbeaeb098869e4b6ae25dc6a1d48f81d952531bfbe41fa2ccf4c36b37a72d853ef32ecc71d1afdbcd1efae02a2c724c8ad07b7df4be2594c6b5fb69af251e802eed7c78e4809c70778c7f
//2019-03-16T18:33:32.867326Z	info	core/password_data.go:493	81d76d424ffc387cf1408faed0e444d32995c5358a6b2b82df9467dbdfa8e053
//2019-03-16T18:33:32.867341Z	info	core/password_data.go:494	6d7afa362ca30cc2685d0ec3ddf4135254d2662985220f827ffb5a69121236f9

//2b084edd60424af09bdba816b2419977881803b662f44e90f1e1ddc1ad2fbf133a1734ce15372fa7afa6bfa0291ffff4f9d5470d6a9999377ecfc37fc513075e721f19657e94e912776df0e38aa0bc690b66f75b3d518e94de79a97ab1ff3acbf749809f4fa7a2ba77985443a821b3c443b8da311440500ee53865be36c60f4ecbdcf71c7cf3c43faab96cc69ebbaa06683b47d9cfa6ed3a2805ed710ac040a2518fcb9cfc0a0545e8593327b4dc9267c04583b67cd973d2318caee591f2c0a8795bac44ec143069249e6f08e6c6609c03b05ab54a995850c552da155e0fdc38107e7e49069c0026f834fe1e7d127e64e6a08655bec0045c87f192a7eca9d205
//61089f85e3790945435cb25b76bcb4a124baa763d3ad4e7376c3580a967420c2cae455bd04d79775abe9b65fc36bb3f0c182eafae9cab20674be16a01247128ad28fda49b74e95473017482ae336e507b7310bc992edaaf90cf5cd0dd54dd8d01879723a4525b44e6109cd451eac29f05214a222dfb614af8d7a9a13d7062a55a83d96c7d5dca80183a5be363c76139a25509463b6c3c28307718a9075c5644ee9da43207246f1dcbde9931a15cfb729a73444c91871e4c02b530671fddeb8e8d18b19921bed791d0f32c81885171ac10668b01a5b89e0b866cd2908f72851044aa7f60d761f5dec9415568ad6d7661b7ed958c1d55603c8b4526c1c100eb8
//
//61089F85E3790945435CB25B76BCB4A124BAA763D3AD4E7376C3580A967420C2CAE455BD04D79775ABE9B65FC36BB3F0C182EAFAE9CAB20674BE16A01247128AD28FDA49B74E95473017482AE336E507B7310BC992EDAAF90CF5CD0DD54DD8D01879723A4525B44E6109CD451EAC29F05214A222DFB614AF8D7A9A13D7062A55A83D96C7D5DCA80183A5BE363C76139A25509463B6C3C28307718A9075C5644EE9DA43207246F1DCBDE9931A15CFB729A73444C91871E4C02B530671FDDEB8E8D18B19921BED791D0F32C81885171AC10668B01A5B89E0B866CD2908F72851044AA7F60D761F5DEC9415568AD6D7661B7ED958C1D55603C8B4526C1C100EB8D
//61089F85E3790945435CB25B76BCB4A124BAA763D3AD4E7376C3580A967420C2CAE455BD04D79775ABE9B65FC36BB3F0C182EAFAE9CAB20674BE16A01247128AD28FDA49B74E95473017482AE336E507B7310BC992EDAAF90CF5CD0DD54DD8D01879723A4525B44E6109CD451EAC29F05214A222DFB614AF8D7A9A13D7062A55A83D96C7D5DCA80183A5BE363C76139A25509463B6C3C28307718A9075C5644EE9DA43207246F1DCBDE9931A15CFB729A73444C91871E4C02B530671FDDEB8E8D18B19921BED791D0F32C81885171AC10668B01A5B89E0B866CD2908F72851044AA7F60D761F5DEC9415568AD6D7661B7ED958C1D55603C8B4526C1C100EB8D
//61089f85e3790945435cb25b76bcb4a124baa763d3ad4e7376c3580a967420c2cae455bd04d79775abe9b65fc36bb3f0c182eafae9cab20674be16a01247128ad28fda49b74e95473017482ae336e507b7310bc992edaaf90cf5cd0dd54dd8d01879723a4525b44e6109cd451eac29f05214a222dfb614af8d7a9a13d7062a55a83d96c7d5dca80183a5be363c76139a25509463b6c3c28307718a9075c5644ee9da43207246f1dcbde9931a15cfb729a73444c91871e4c02b530671fddeb8e8d18b19921bed791d0f32c81885171ac10668b01a5b89e0b866cd2908f72851044aa7f60d761f5dec9415568ad6d7661b7ed958c1d55603c8b4526c1c100eb8d0
//3ADD91CBC5444E7EE98BF9624D9A4E8ADC64B3AB6B984303953C3A6C04428120F7A70D81081C0CF9B65C0BEB02F19772556FBBB69579A203B8D0617314096DBD54C336E78E53E3FD0E01F2C8F66660A9A95201539F89A7466D26AE6CB06486D737598C2947344D3C51DB0EAC76CF970EFDA95EA85084DCA2B8D38D8545A32FC8344214845E00AD0B663736FB265342CAA960EA618CB99A6990954674BD695806132835466638293185C6293D8C76AD65B465C166F785DA82A4869BC01D55788FB0954E161F5A35C5556314AFD28927746D51E8A06A0FBCE029654B824CD39A2F4BB19CC84EEB1C04FFD7EAC037B49FED8735BA3175BCAAFB6ECFCADF410BD5D
//
////
//B5891ACCBE53725DCBD164381E21C9A1C1198BFEEEED5CC456202525BBC52CB68755C334CA78F093A7ABE71C4E558F4501F6D3872BD69C89EBA79684C1F3FFE60885400C85273510834EDCAFB639D736291891E0A8C8CC8A339773BC64D78680239B250F3CD733B3791FC8D3A9B8357A0E8CCD87387FD949B42BF66229C66890030AAC6F97AD5A77B8E9496E9F427DD24EA61A57DCCAA09EDC53CF87A7B15823A8FDB6E5E683A7C6088AACA782C76081C761584153ADBEAEB098869E4B6AE25DC6A1D48F81D952531BFBE41FA2CCF4C36B37A72D853EF32ECC71D1AFDBCD1EFAE02A2C724C8AD07B7DF4BE2594C6B5FB69AF251E802EED7C78E4809C70778C7

// 61089f85e3790945435cb25b76bcb4a124baa763d3ad4e7376c3580a967420c2cae455bd04d79775abe9b65fc36bb3f0c182eafae9cab20674be16a01247128ad28fda49b74e95473017482ae336e507b7310bc992edaaf90cf5cd0dd54dd8d01879723a4525b44e6109cd451eac29f05214a222dfb614af8d7a9a13d7062a55a83d96c7d5dca80183a5be363c76139a25509463b6c3c28307718a9075c5644ee9da43207246f1dcbde9931a15cfb729a73444c91871e4c02b530671fddeb8e8d18b19921bed791d0f32c81885171ac10668b01a5b89e0b866cd2908f72851044aa7f60d761f5dec9415568ad6d7661b7ed958c1d55603c8b4526c1c100eb8d0

//ECF8737665BC775A30A7681CE4FA69CB712BFE40C746956EFAA31B7D3E75A15FDAC9B475F026A1C
//BE DE 48 88 8C 0F 42 AC 34 FF D1 D4 93 5D 8B 2

//B51B09D6C6484D78ABB6CE100066C1FB674AE7404F08EC9B9BB1AD947F87DCAECDA863A4633887C698C1A486EF3878C95247A4DEF3B90EF383521733FF49FC2E013070A33E00A6BD4ECA765E71944C53A35FCA097153E06F9C32091B1004ACC12CD8950587C7B6E219BE8F24D368D9363C85FCBBDD0C308809A309BF4485CD57063DD35657078F7F9C35FF78F721A43B44E86473E39FBEE2F884EA3C7C6C1496D8D98C6B186C03DF5DD6DECDF79FE25E481E5D393C62B20085F135849FDDD28BA45BEDE42053C7546CD96F8A9B9118C5C4E957ECAB8F00351458076ED8EA19DA32F38EA5D781B3245921C3A093D7B40E3044742FB5FDFEABABDA16063388766C
//414C88BAFB9D2A8451F0D7E1B0EB30B8D718279D205421FBD6E453530FA1ABDB9777EFB86C9B1596481D2B4D16A6D475C2FB7B88B08B95BDC769DC98E268BA2C31FAD79221AD04C62D0D976972330380A6B16901D1BCB69A545A0FE9B9E62365DF01F177FC1032EB68B7B6BEB22EB0EB68031762942941268DFF3F509A983CE43885607E9FB772DBD0B48832FA3952142CEF023619EE95613B3874D3353C2ED46F20795110AE70E0A2EEDC651C2926401D2C1D94EEE949654B17DC35B8918625AA052196732983A32F6874E8672FB57544076B152B45CCFEA0E76A8721CA863596FF953605498CC567E56335BEA5E3837965488BA689DBBD5E36EFB3912870CD
//414C88BAFB9D2A8451F0D7E1B0EB30B8D718279D205421FBD6E453530FA1ABDB9777EFB86C9B1596481D2B4D16A6D475C2FB7B88B08B95BDC769DC98E268BA2C31FAD79221AD04C62D0D976972330380A6B16901D1BCB69A545A0FE9B9E62365DF01F177FC1032EB68B7B6BEB22EB0EB68031762942941268DFF3F509A983CE43885607E9FB772DBD0B48832FA3952142CEF023619EE95613B3874D3353C2ED46F20795110AE70E0A2EEDC651C2926401D2C1D94EEE949654B17DC35B8918625AA052196732983A32F6874E8672FB57544076B152B45CCFEA0E76A8721CA863596FF953605498CC567E56335BEA5E3837965488BA689DBBD5E36EFB3912870CD
//10CF4460BFB025D0AF7D815B26C58B7480721D21AEBB2DE106247FF8BC2A1759

// 2019-03-17T00:08:57.293823Z	info	core/password_data.go:493	c47b7c8475272e1be9808ace918e27dc8b8dbfa3605b46a38ea5ce0b27466aef
// 2019-03-17T00:08:57.293837Z	info	core/password_data.go:494	10cf4460bfb025d0af7d815b26c58b7480721d21aebb2de106247ff8bc2a1759
// AC0C9118B2D4E3AA6C5797FD5C2EFE5F6F271AE46DF23926165ECBCBDE7E7263
//
